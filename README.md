# Email Fetcher and Sender

This repository contains two Python scripts for handling Gmail emails: one for fetching and parsing sent emails during a specific time range, and the other for sending emails with attachments using data from a CSV file generated by the first script.

## Introduction

### gmail_sent_email_fetcher.py

This script connects to your Gmail account using IMAP, fetches emails sent between specified dates, parses the sender's email address and email content, and writes the parsed data into a CSV file.

### email_sender.py

This script reads the CSV file generated by `gmail_sent_email_fetcher.py`, extracts email addresses and additional data, and sends personalized emails with attachments to the recipients.

## Prerequisites

Before running these scripts, ensure you have:

- Python 3.x installed on your machine.
- Required Python packages installed. You can install them using pip:

  ```bash
  pip install imaplib email smtplib
  ```

## Usage

### 1. Setting up `gmail_sent_email_fetcher.py`

1. **Modify Script:**
   - Open `gmail_sent_email_fetcher.py` and update the following variables:
     - `IMAP_SERVER`: Your IMAP server address (e.g., 'imap.gmail.com').
     - `EMAIL`: Your Gmail email address.
     - `PASSWORD`: Your Gmail account password or an app-specific password if two-factor authentication (2FA) is enabled.

2. **Specify Date Range:**
   - Set `start_date` and `end_date` variables in `main()` function to specify the date range from which you want to fetch emails.

3. **Modify parse_email_content Function:**
   - Modify the function as per your specific parsing needs. For example, you can adjust the regular expression pattern to match the content format you expect to parse.

4. **Run the Script:**
   - Execute the script using Python:

     ```bash
     python gmail_sent_email_fetcher.py
     ```

   - This will fetch the sent emails within the specified date range, parse the required data, and store it in a CSV file named `parsed_cafe_names.csv`.

### 2. Setting up `email_sender.py`

1. **Modify Script:**
   - Open `email_sender.py` and update the following variables:
     - `gmail_email`: Your Gmail email address.
     - `gmail_password`: Your Gmail account password or an app-specific password if two-factor authentication (2FA) is enabled.

2. **Prepare Email Template:**
   - Customize the `body` variable in the `email_draft()` function to suit your email content and template.

3. **Attach Resume (Optional):**
   - Modify `attachment_path` variable in `email_draft()` function to specify the path to the attachment (e.g., resume file).

4. **Run the Script:**
   - Execute the script using Python:

     ```bash
     python email_sender.py
     ```

   - This will read the `parsed_cafe_names.csv` file, send personalized emails with attachments to each recipient listed in the CSV file, and provide feedback on the console regarding the status of each email sent.
